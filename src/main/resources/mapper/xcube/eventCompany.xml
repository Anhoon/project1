<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "mybatis-3-mapper.dtd">

<mapper namespace="eventCompany">
	
	<select id="selectMasterLicenseList" resultType="ParamMap">
		SELECT 
			OBID, 
			CREATED_ON, 
			EMAIL, 
			ORGANIZER, 
			TEL, 
			MANAGER, 
			JOB_POSITION, 
			HOMEPAGE, 
			HISTORY, 
			ATTATCH_OBID
		FROM MASTER_LICENSE
	</select>

	<select id="selectMasterLicense" resultType="ParamMap">
		SELECT 
			OBID, 
			CREATED_ON, 
			EMAIL, 
			ORGANIZER, 
			TEL, 
			MANAGER, 
			JOB_POSITION, 
			HOMEPAGE, 
			HISTORY, 
			ATTATCH_OBID
		FROM MASTER_LICENSE
		WHERE OBID = #{obid}
		<if test="email != null and email != '' " >
			AND EMAIL = #{email}
		</if>
	</select>

	<select id="selectMasterLicenseListDetailList" resultType="ParamMap">
		SELECT 
			OBID, 
			REF_OBID, 
			TYPE, 
			STATUS, 
			START_DATE, 
			END_DATE, 
			EXPRESSION, 
			HOLD_TYPE, 
			ATTATCH_OBID
		FROM MASTER_LICENSE_LIST
		WHERE REF_OBID = #{refObid}
	</select>

	<insert id="insertMasterLicense" parameterType="java.util.HashMap">
		INSERT INTO MASTER_LICENSE 
		(
			OBID, 
			CREATED_ON, 
			EMAIL, 
			ORGANIZER, 
			TEL, 
			MANAGER, 
			JOB_POSITION, 
			HOMEPAGE, 
			HISTORY, 
			ATTATCH_OBID
		) 
		VALUES 
		(
			#{obid},
			SYSDATE(),
			#{email}, 
			#{organizer},
			#{tel},
			#{manager},
			#{jobPosition},
			#{homepage},
			#{history},
			#{attatchObid}
		)
	</insert>

	<insert id="insertMasterLicenseList" parameterType="java.util.List">
		INSERT INTO MASTER_LICENSE_LIST 
		(
			OBID, 
			REF_OBID, 
			TITLE,
			TYPE, 
			STATUS, 
			START_DATE, 
			END_DATE, 
			EXPRESSION, 
			HOLD_TYPE, 
			ATTATCH_OBID
		) 
		VALUES
		<foreach collection="list" item="item" separator=",">
		(
			#{item.obid},
			#{item.refObid}, 
			#{item.title}, 
			#{item.type},
			#{item.status},
			CONVERT(#{item.startDate}, DATETIME),
			CONVERT(#{item.endDate}, DATETIME),
			#{item.expression},
			#{item.holdType},
			#{item.attatchObid}
		)
		</foreach>
	</insert>

	<update id="updateMasterLicense" parameterType="java.util.HashMap">
		UPDATE MASTER_LICENSE SET
			ORGANIZER = #{organizer},
			TEL = #{tel}, 
			MANAGER = #{manager}, 
			JOB_POSITION = #{jobPosition}, 
			HOMEPAGE = #{homepage}, 
			HISTORY = #{history}
		WHERE OBID = #{obid}
	</update>

	<update id="updateMasterLicenseList" parameterType="java.util.HashMap">
		UPDATE MASTER_LICENSE_LIST SET
			TITLE = #{title},
			TYPE = #{type},
			STATUS = #{status},
			START_DATE = #{startDate},
			END_DATE = #{endDate},
			EXPRESSION = #{expression},
			HOLD_TYPE = #{holdType}
		WHERE OBID = #{obid}
	</update>

	<update id="updateMasterLicenseStatus" parameterType="java.util.HashMap">
		UPDATE MASTER_LICENSE_LIST SET
			STATUS = #{status}
		WHERE OBID = #{obid}
	</update>
</mapper>